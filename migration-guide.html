<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.8.1 from src/site/markdown/migration-guide.md at 2021-08-26
 | Rendered using Apache Maven Fluido Skin 1.7
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="Date-Revision-yyyymmdd" content="20210826" />
    <meta http-equiv="Content-Language" content="en" />
    <title>BlackLab Core &#x2013; Migrating from BlackLab 1.7 to 2.0</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.7.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />
    <script type="text/javascript" src="./js/apache-maven-fluido-1.7.min.js"></script>
<link href='http://fonts.googleapis.com/css?family=Nunito:300' rel='stylesheet' type='text/css' />
  </head>
  <body class="topBarDisabled">
    <div class="container-fluid">
      <div id="banner">
        <div class="pull-left"><a href="http://www.ivdnt.org/" id="bannerLeft"><img src="images/logo_2_ivd-nt_transparant.png"  alt="Dutch Language Institute (INT)"/></a></div>
        <div class="pull-right"><a href="BlackLab/" id="bannerRight"><img src="images/logo-blacklab.png"  alt="BlackLab"/></a></div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
      <li class=""><a href="http://www.ivdnt.org/" class="externalLink" title="INT">INT</a><span class="divider">/</span></li>
      <li class=""><a href="index.html" title="BlackLab">BlackLab</a><span class="divider">/</span></li>
    <li class="active ">Migrating from BlackLab 1.7 to 2.0</li>
        <li id="publishDate" class="pull-right"><span class="divider">|</span> Last Published: 2021-08-26</li>
          <li id="projectVersion" class="pull-right">Version: 2.2.0-SNAPSHOT</li>
        </ul>
      </div>
      <div class="row-fluid">
        <div id="leftColumn" class="span2">
          <div class="well sidebar-nav">
    <ul class="nav nav-list">
      <li class="nav-header">BlackLab</li>
    <li><a href="index.html" title="Introduction"><span class="none"></span>Introduction</a></li>
    <li><a href="learn.html" title="Learn"><span class="icon-chevron-down"></span>Learn</a>
    <ul class="nav nav-list">
    <li><a href="getting-started.html" title="Getting Started"><span class="none"></span>Getting Started</a></li>
    <li><a href="corpus-query-language.html" title="Corpus Query Language"><span class="none"></span>Corpus Query Language</a></li>
    <li><a href="blacklab-server-overview.html" title="BlackLab Server overview"><span class="none"></span>BlackLab Server overview</a></li>
    <li><a href="configuration-files.html" title="Configuration files"><span class="none"></span>Configuration files</a></li>
    <li><a href="blacklab-server-different-languages.html" title="Using BlackLab Server from different languages"><span class="none"></span>Using BlackLab Server from different languages</a></li>
    <li><a href="indexing-with-blacklab.html" title="Indexing with BlackLab"><span class="none"></span>Indexing with BlackLab</a></li>
    <li><a href="add-input-format.html" title="Add An Input Format"><span class="none"></span>Add An Input Format</a></li>
    <li><a href="improve-search-speed.html" title="Improve Search Speed"><span class="none"></span>Improve Search Speed</a></li>
    <li><a href="apidocs/index.html" title="API reference"><span class="none"></span>API reference</a></li>
    <li><a href="file-formats.html" title="File formats"><span class="none"></span>File formats</a></li>
    </ul>
</li>
    <li><a href="downloads.html" title="Downloads"><span class="none"></span>Downloads</a></li>
    <li><a href="faq.html" title="FAQ"><span class="none"></span>FAQ</a></li>
    <li><a href="changelog.html" title="Change Log"><span class="none"></span>Change Log</a></li>
    <li><a href="roadmap.html" title="Road Map"><span class="none"></span>Road Map</a></li>
    <li><a href="newsletter.html" title="Newsletter"><span class="none"></span>Newsletter</a></li>
      <li class="nav-header">Project Documentation</li>
    <li><a href="project-info.html" title="Project Information"><span class="icon-chevron-right"></span>Project Information</a></li>
    <li><a href="project-reports.html" title="Project Reports"><span class="icon-chevron-right"></span>Project Reports</a></li>
</ul>
          <hr />
          <div id="poweredBy">
            <div class="clear"></div>
            <div class="clear"></div>
            <div class="clear"></div>
            <div class="clear"></div>
<a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy"><img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" /></a>
            </div>
          </div>
        </div>
        <div id="bodyColumn"  class="span10" >
<h1>Migrating from BlackLab 1.7 to 2.0</h1>
<p>BlackLab Server 2.0 contains one significant change to the API: metadata values are now always reported as lists, even if there is only one value. Because it is now possible to index multiple values for a single metadata field (for example, to associate two authors or two images with one document), this change was required.</p>
<p>Where BlackLab 2.0 does differ significantly is in its Java API and configuration files. If you use the Java API, for example because you&#x2019;ve written your own DocIndexer class, this page helps you migrate it to 2.0.</p>
<ul>

<li><a href="#terminology">Terminology</a></li>
<li><a href="#configfiles">Migrating the configuration file(s)</a></li>
<li><a href="#docindexers">Migrating DocIndexers</a></li>
<li><a href="#methods">Method naming</a></li>
<li><a href="#renamed">Important renamed packages and classes</a></li>
<li><a href="#programs">Migrating BlackLab programs</a></li>
</ul>
<p><a name="terminology" id="terminology"></a></p>
<div class="section">
<h2><a name="Terminology"></a>Terminology</h2>
<ul>

<li>&#x201c;Searcher&#x201d; -&gt; &#x201c;BlackLab index&#x201d;</li>
<li>&#x201c;complex field&#x201d; -&gt; &#x201c;annotated field&#x201d;</li>
<li>&#x201c;property on a complex field&#x201d; -&gt; &#x201c;annotation on an annotated field&#x201d;</li>
<li>&#x201c;an indexed alternative for a property&#x201d; (e.g. case- and diacritics-insensitive) -&gt; &#x201c;an indexed sensitivity for an annotation&#x201d;</li>
</ul>
<p>So, for example, an annotated field &#x201c;contents&#x201d; might have annotations &#x201c;word&#x201d;, &#x201c;lemma&#x201d; and &#x201c;pos&#x201d; (part of speech), and the &#x201c;word&#x201d; annotation might have two sensitivities indexed: (case- and diacritics-) sensitive, and (case- and diacritics-) insensitive.</p>
<p><a name="configfiles" id="configfiles"></a></p></div>
<div class="section">
<h2><a name="Migrating_the_configuration_file.28s.29"></a>Migrating the configuration file(s)</h2>
<p>Usually you will use either a file <tt>blacklab-server.yaml</tt> (for BlackLab Serer), or <tt>blacklab.yaml</tt> (for e.g. IndexTool, QueryTool or other BlackLab applications). (JSON works too if you prefer)</p>
<p>A new, cleaner format was added in BlackLab 2.0. The old format still works, but it is a good idea to convert to the new format as the old format will eventually be removed.</p>
<p>For more information about the config file format, see <a href="configuration-files.html">Configuration files</a>.</p>
<p><a name="docindexers" id="docindexers"></a></p></div>
<div class="section">
<h2><a name="Migrating_DocIndexers"></a>Migrating DocIndexers</h2>
<p>If you have a custom implementation of DocIndexer for your own input format, please ensure that it has a default constructor. If instead if has a constructor that takes an <tt>Indexer</tt>, change <tt>Indexer</tt> to <tt>DocWriter</tt>.</p>
<p><a name="configfiles" id="configfiles"></a></p></div>
<div class="section">
<h2><a name="Method_naming"></a>Method naming</h2>
<p>For many classes, methods were renamed from getSomeThing() to simply someThing(). While this may not be the convention in Java, it makes for less noisy, more natural-sounding code, especially when chaining methods. It also saves on typing. For example, compare these two examples:</p>

<div>
<div>
<pre class="source">String luceneField = index
    .getAnnotatedField(&quot;contents&quot;)
    .getAnnotation(&quot;word&quot;)
    .getSensitivity(MatchSensitivity.SENSITIVE)
    .getLuceneField();

String luceneField = index
    .annotatedField(&quot;contents&quot;)
    .annotation(&quot;word&quot;)
    .sensitivity(MatchSensitivity.SENSITIVE)
    .luceneField();
</pre></div></div>

<p><a name="renamed" id="renamed"></a></p></div>
<div class="section">
<h2><a name="Important_renamed_packages_and_classes"></a>Important renamed packages and classes</h2>
<p>General: - Searcher -&gt; BlackLabIndex</p>
<p>Classes used while indexing: - ComplexField -&gt; AnnotatedFieldWriter - ComplexFieldProperty -&gt; AnnotationWriter - ComplexFieldUtil -&gt; AnnotatedFieldNameUtil</p>
<p>Index structure: - IndexStructure -&gt; IndexMetadata - ComplexFieldDesc -&gt; AnnotatedField - PropertyDesc -&gt; Annotation</p>
<p>Packages: - nl.inl.blacklab.search.indexstructure -&gt; .search.indexmetadata - nl.inl.blacklab.externalstorage -&gt; .contentstore</p>
<p><a name="programs" id="programs"></a></p>
<h1>Migrating BlackLab programs</h1>
<p>Methods: - instead of BlackLabIndex.open(), use BlackLab.open()</p></div>
        </div>
      </div>
    </div>
    <hr/>
    <footer>
      <div class="container-fluid">
        <div class="row-fluid">
            <p>Copyright &copy;2021
<a href="https://www.ivdnt.org/">Instituut voor Nederlandse Taal (INT)</a>.
All rights reserved.</p>
        </div>
      </div>
    </footer>
  </body>
</html>
